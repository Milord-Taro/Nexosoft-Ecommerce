{% load static %}
{% load formatos %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{% if producto %}Editar{% else %}Nuevo{% endif %} producto – Nexosoft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
<div class="app-wrapper">

  <header class="main-header">
    <div class="brand">
      <a href="{% url 'landing' %}">
        <img src="{% static 'img/logo.png' %}" alt="NEXOSOFT Logo">
      </a>
    </div>
    <div class="header-actions">
      <a href="{% url 'admin_productos_list' %}" class="btn-outline">Volver al listado</a>
    </div>
  </header>

  <main class="perfil-layout">
    <section class="perfil-main">
      <div class="perfil-main-card">
        <h1 class="perfil-title">
          {% if producto %}Editar{% else %}Nuevo{% endif %} producto
        </h1>

        <form method="post" class="perfil-form">
          {% csrf_token %}

          <div class="perfil-grid">
            <div class="perfil-field">
              <label for="nombreProducto">Nombre del producto</label>
              <input type="text" id="nombreProducto" name="nombreProducto"
                     value="{{ producto.nombreProducto|default:'' }}" required>
            </div>

            <div class="perfil-field">
              <label for="marcaProducto">Marca</label>
              <input type="text" id="marcaProducto" name="marcaProducto"
                     value="{{ producto.marcaProducto|default:'' }}" required>
            </div>

            <div class="perfil-field perfil-field-wide">
              <label for="descripcionCortaProducto">Descripción corta</label>
              <textarea id="descripcionCortaProducto"
                        name="descripcionCortaProducto"
                        rows="3"
                        required>{{ producto.descripcionCortaProducto|default:'' }}</textarea>
            </div>

            <div class="perfil-field">
              <label for="unidadMedidaProducto">Unidad de medida</label>
              <select id="unidadMedidaProducto" name="unidadMedidaProducto" required>
                <option value="">Seleccione...</option>
                {% for u in unidades_medida %}
                  <option value="{{ u }}"
                    {% if producto and producto.unidadMedidaProducto == u %}selected{% endif %}>
                    {{ u|capfirst }}
                  </option>
                {% endfor %}
              </select>
            </div>

            <div class="perfil-field">
              <label for="skuProducto">SKU</label>
              <input type="text" id="skuProducto" name="skuProducto"
                     value="{{ producto.skuProducto|default:'' }}" required>
            </div>

            <div class="perfil-field">
              <label for="codigoBarrasProducto">Código de barras (EAN-13)</label>
              <input type="text" id="codigoBarrasProducto" name="codigoBarrasProducto"
                     value="{{ producto.codigoBarrasProducto|default:'' }}" required>
            </div>

            <div class="perfil-field">
              <label for="precioVenta">Precio de venta</label>
              <input type="number" step="0.01" min="0"
                     id="precioVenta" name="precioVenta"
                     value="{{ producto.inventario.precioVenta|default:'' }}" required>
            </div>

            <div class="perfil-field">
              <label for="stockActual">Stock actual</label>
              <input type="number" min="0"
                     id="stockActual" name="stockActual"
                     value="{{ producto.inventario.stockActual|default:'0' }}" required>
            </div>

            <div class="perfil-field">
              <label for="stockMinimo">Stock mínimo</label>
              <input type="number" min="0"
                     id="stockMinimo" name="stockMinimo"
                     value="{{ producto.inventario.stockMinimo|default:'0' }}" required>
            </div>

            <div class="perfil-field perfil-field-wide">
              <label for="imagenUrl">URL de la imagen</label>
              <input type="url" id="imagenUrl" name="imagenUrl"
                     value="{{ producto.imagenUrl|default:'' }}">
            </div>

            <div class="perfil-field">
              <label for="estadoProducto">Estado</label>
              <select id="estadoProducto" name="estadoProducto" required>
                <option value="activo"
                  {% if not producto or producto.estadoProducto == "activo" %}selected{% endif %}>
                  Activo
                </option>
                <option value="inactivo"
                  {% if producto and producto.estadoProducto == "inactivo" %}selected{% endif %}>
                  Inactivo
                </option>
              </select>
            </div>
          </div>

          <div class="perfil-actions">
            <button type="submit" class="btn-primary">
              {% if producto %}Guardar cambios{% else %}Crear producto{% endif %}
            </button>
            <a href="{% url 'admin_productos_list' %}" class="btn-outline">
              Cancelar
            </a>
          </div>
        </form>
      </div>
    </section>
  </main>

</div>
</body>
</html>
